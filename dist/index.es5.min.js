var GraphQLClient=function(e){"use strict";const s=(()=>{let e=0;return s=>`${s}${e++}`})(),t=/\s|\(|{/,r=(e,r,i)=>{const{query:n,variables:u}=((e,t)=>{const r=[],i=[],n={};return Object.keys(t).forEach(e=>{const u=t[e];let l=u.query;Object.keys(u.decls).sort((e,s)=>s.length-e.length).forEach(e=>{const t=s(e);l=l.replace(`$${e}`,`$${t}`),i.push(`$${t}: ${u.decls[e].type}`),n[t]=u.decls[e].value}),r.push(`${e}:${l}`)}),{query:`${e}${i.length?`(${i.join(",")})`:""}{\n${r.join("\n")}\n}`,variables:n}})(e,r);i(n,u,(e=>({data:s,errors:r})=>{const i={},n={};s&&Object.keys(s).forEach(r=>{const u=e[r].query.split(t,1)[0];i[r]={data:{[u]:s[r]}},n[r]=u}),r&&r.forEach(e=>{if(e.fields&&e.fields.length){const s=e.fields[0];if(!n[s])return;i[s]||(i[s]={errors:[]}),i[s].errors||(i[s].errors=[]),i[s].errors.push({message:e.message,fields:[n[s]].concat(e.fields.slice(1))})}}),Object.keys(i).forEach(s=>{e[s]&&e[s].resolve(i[s])})})(r),(e=>(...s)=>{Object.keys(e).forEach(t=>{e[t].reject(...s)})})(r))};return e.GraphQLClient=class{constructor(e){this.buffers={query:{},mutation:{}},this.timerIds={query:null,mutation:null},this.wait=null==e.wait?50:e.wait,this.handle=e.handle}query(e,s={}){return this.buffer("query",e,s)}mutation(e,s={}){return this.buffer("mutation",e,s)}buffer(e,t,r){return new Promise((i,n)=>{this.buffers[e][s("alias")]={query:t,decls:r,resolve:i,reject:n},this.timerIds[e]||(this.timerIds[e]=setTimeout(()=>{this.flush(e)},this.wait))})}flush(e){r(e,this.buffers[e],this.handle),this.buffers[e]={},this.timerIds[e]=null}},e}({});
